(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4303,e=>{"use strict";let t="https://api.whatsonchain.com/v1/bsv/main";function a(e){let t=e=>{let t=new ArrayBuffer(4);return new DataView(t).setUint32(0,e,!0),Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")},a=e=>(e.match(/.{2}/g)??[]).reverse().join(""),s=parseInt(e.bits,16);return[t(e.version),a(e.prevBlockHash.padStart(64,"0")),a(e.merkleRoot.padStart(64,"0")),t(e.time),t(s),t(e.nonce)].join("")}async function s(e,a){try{let s=await fetch(`${t}/block/height/${e}`,{signal:a});if(!s.ok)return null;let r=await s.json();return{hash:r.hash,height:r.height,version:r.version,prevBlockHash:r.previousblockhash??"",merkleRoot:r.merkleroot,time:r.time,bits:r.bits,nonce:r.nonce}}catch{return null}}async function r(e){try{let a=await fetch(`${t}/chain/info`,{signal:e});if(!a.ok)return null;return(await a.json()).blocks??null}catch{return null}}let n=[{name:"WhatsOnChain",fetchTip:r,fetchHeader:s}];async function i(e){let t=[],a=n.map(async t=>{try{let a=await t.fetchTip(e);return{source:t.name,height:a}}catch{return{source:t.name,height:null}}});t.push(...await Promise.all(a));let s=t.filter(e=>null!==e.height);if(0===s.length)return{height:null,consensus:!1,sources:[]};if(1===s.length)return{height:s[0].height,consensus:!1,sources:[s[0].source]};let r=new Map;for(let e of s)if(null!==e.height){let t=r.get(e.height)||[];t.push(e.source),r.set(e.height,t)}let i=null,l=[];for(let[e,t]of r)t.length>=2&&t.length>l.length&&(i=e,l=t);if(null!==i)return{height:i,consensus:!0,sources:l};let o=s.reduce((e,t)=>(t.height??0)>(e.height??0)?t:e);return{height:o.height,consensus:!1,sources:[o.source]}}async function l(e,a){try{let s=await fetch(`${t}/tx/${e}/hex`,{signal:a});if(!s.ok)return null;return await s.text()}catch{return null}}async function o(a,s){try{let{Beef:r,MerklePath:n,Transaction:i}=await e.A(28627),o=await l(a,s);if(!o)return console.warn(`[assembleBeef] Could not fetch raw tx for ${a}`),null;let d=await fetch(`${t}/tx/${a}/proof/tsc`,{signal:s});if(!d.ok)return console.warn(`[assembleBeef] Could not fetch TSC proof for ${a}`),null;let c=await d.json(),u=Array.isArray(c)?c[0]:c;if(!u||"number"!=typeof u.index||!Array.isArray(u.nodes))return console.warn(`[assembleBeef] Invalid TSC proof format for ${a}`,u),null;let h="height"===u.targetType?u.target:u.blockHeight??0;if(!h){let e=u.target;if(e&&"string"==typeof e&&64===e.length){let a=await fetch(`${t}/block/hash/${e}`,{signal:s});if(a.ok){let e=await a.json();e.height&&(u.blockHeight=e.height)}}}let x=u.blockHeight??h;if(!x)return console.warn(`[assembleBeef] Could not determine block height for ${a}`),null;let f=[],p=u.index,m=[{offset:p,hash:a,txid:!0}];if(u.nodes.length>0){let e=u.nodes[0],t=p%2==0?p+1:p-1;"*"===e?m.push({offset:t,duplicate:!0}):m.push({offset:t,hash:e})}f.push(m),p=Math.floor(p/2);for(let e=1;e<u.nodes.length;e++){let t=u.nodes[e],a=p%2==0?p+1:p-1,s=[];"*"===t?s.push({offset:a,duplicate:!0}):s.push({offset:a,hash:t}),f.push(s),p=Math.floor(p/2)}let g=new n(x,f);g.computeRoot(a);let b=i.fromHex(o);b.merklePath=g;let v=new r;return v.mergeTransaction(b),{beefHex:v.toHex(),height:x}}catch(e){return console.error(`[assembleBeef] Error assembling BEEF for ${a}:`,e),null}}e.s(["assembleBeefFromTxid",()=>o,"constructHeaderHex",()=>a,"fetchChainTip",()=>r,"fetchChainTipMultiSource",()=>i,"fetchHeaderByHeight",()=>s,"fetchRawTx",()=>l])},24687,e=>{"use strict";var t=e.i(43476),a=e.i(75157);function s({className:e,...s}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,a.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...s})}e.s(["Textarea",()=>s])},72436,48425,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(74080);var s=e.i(91918),r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let n=(0,s.createSlot)(`Primitive.${r}`),i=a.forwardRef((e,a)=>{let{asChild:s,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(s?n:r,{...i,ref:a})});return i.displayName=`Primitive.${r}`,{...e,[r]:i}},{});e.s(["Primitive",()=>r],48425);var n="horizontal",i=["horizontal","vertical"],l=a.forwardRef((e,a)=>{var s;let{decorative:l,orientation:o=n,...d}=e,c=(s=o,i.includes(s))?o:n;return(0,t.jsx)(r.div,{"data-orientation":c,...l?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...d,ref:a})});l.displayName="Separator";var o=e.i(75157);function d({className:e,orientation:a="horizontal",decorative:s=!0,...r}){return(0,t.jsx)(l,{"data-slot":"separator",decorative:s,orientation:a,className:(0,o.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}e.s(["Separator",()=>d],72436)},15288,e=>{"use strict";var t=e.i(43476),a=e.i(75157);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function r({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function n({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>i,"CardHeader",()=>r,"CardTitle",()=>n])},93479,e=>{"use strict";var t=e.i(43476),a=e.i(75157);function s({className:e,type:s,...r}){return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}e.s(["Input",()=>s])},10204,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(48425),r=a.forwardRef((e,a)=>(0,t.jsx)(s.Primitive.label,{...e,ref:a,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));r.displayName="Label";var n=e.i(75157);function i({className:e,...a}){return(0,t.jsx)(r,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...a})}e.s(["Label",()=>i],10204)},79406,e=>{"use strict";var t=e.i(43476),a=e.i(72436),s=e.i(81611),r=e.i(71645),n=e.i(87486),i=e.i(74153),l=e.i(28409),o=e.i(45232),d=e.i(4303),c=e.i(15288),u=e.i(19455),h=e.i(93479),x=e.i(10204),f=e.i(24687);function p({inputType:e,setInputType:a,inputValue:s,setInputValue:r,fetchStatus:n,fetching:i,isOnline:l,onContinue:o}){return(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsx)(c.CardTitle,{children:"Identify Funding Transaction"})}),(0,t.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(u.Button,{variant:"utxo"===e?"default":"outline",size:"sm",onClick:()=>a("utxo"),children:"UTXO / Txid"}),(0,t.jsx)(u.Button,{variant:"beef"===e?"default":"outline",size:"sm",onClick:()=>a("beef"),children:"BEEF JSON"}),(0,t.jsx)(u.Button,{variant:"rawtx"===e?"default":"outline",size:"sm",onClick:()=>a("rawtx"),children:"Raw Tx Hex"})]}),"utxo"===e&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x.Label,{children:"Transaction ID (or txid:vout)"}),(0,t.jsx)(h.Input,{placeholder:"abc123...def or abc123...def:0",value:s,onChange:e=>r(e.target.value),className:"font-mono text-xs"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:l?"Will fetch transaction data and BEEF proof from WhatsOnChain.":"Switch to Online mode to auto-fetch transaction data."})]}),"beef"===e&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x.Label,{children:"BEEF JSON"}),(0,t.jsx)(f.Textarea,{placeholder:'{"txid": "...", "beef": "base64...", "height": 123456, "utxos": [...]}',value:s,onChange:e=>r(e.target.value),rows:6,className:"font-mono text-xs"})]}),"rawtx"===e&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x.Label,{children:"Raw Transaction Hex"}),(0,t.jsx)(f.Textarea,{placeholder:"0100000001...",value:s,onChange:e=>r(e.target.value),rows:4,className:"font-mono text-xs"})]}),n&&(0,t.jsx)("div",{className:"rounded-md border border-blue-500/20 bg-blue-500/5 p-3 text-sm text-blue-600 dark:text-blue-400",children:n}),(0,t.jsx)(u.Button,{onClick:o,disabled:i,children:i?"Fetching...":"Continue"})]})]})}function m({txid:e,outputs:a,selectedVout:s,setSelectedVout:r,onContinue:n,onBack:i}){return(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsx)(c.CardTitle,{children:"Select Output"})}),(0,t.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Transaction: ",(0,t.jsx)("code",{className:"text-xs",children:e})]}),a.length>0?(0,t.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,t.jsxs)("div",{className:`cursor-pointer rounded-md border p-3 transition-colors ${s===e.vout?"border-primary bg-primary/5":"hover:border-primary/50"}`,onClick:()=>r(e.vout),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"font-medium",children:["Output #",e.vout]}),(0,t.jsxs)("span",{children:[(e.satoshis/1e8).toFixed(8)," BSV"]})]}),(0,t.jsx)("p",{className:"mt-1 truncate text-xs text-muted-foreground",children:e.script_hex})]},e.vout))}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x.Label,{children:"Output Index (vout)"}),(0,t.jsx)(h.Input,{type:"number",min:0,value:s??"",onChange:e=>r(parseInt(e.target.value,10)||0)}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"No outputs detected. Enter the output index manually."})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(u.Button,{onClick:n,children:"Continue"}),(0,t.jsx)(u.Button,{variant:"outline",onClick:i,children:"Back"})]})]})]})}function g({txid:e,selectedVout:a,outputs:s,beefBase64:r,height:n,buckets:i,selectedBucket:l,setSelectedBucket:o,labels:d,setLabels:f,onStore:p,onBack:m}){let g=s.find(e=>e.vout===a);return(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsx)(c.CardTitle,{children:"Store UTXO"})}),(0,t.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"rounded-md border p-3 text-sm",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Outpoint:"})," ",e,":",a]}),g&&(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Value:"})," ",(g.satoshis/1e8).toFixed(8)," BSV"]}),r&&(0,t.jsxs)("p",{style:{color:"#16a34a"},children:[(0,t.jsx)("strong",{children:"BEEF:"})," ✓ Available (height ",n,")"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x.Label,{children:"Bucket"}),(0,t.jsxs)("select",{className:"w-full rounded-md border bg-background px-3 py-2 text-sm",value:l,onChange:e=>o(e.target.value),children:[i.map(e=>(0,t.jsx)("option",{value:e.id,children:e.label},e.id)),0===i.length&&(0,t.jsx)("option",{value:"default",children:"Default"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x.Label,{children:"Labels (comma-separated)"}),(0,t.jsx)(h.Input,{placeholder:"vault, cold-storage",value:d,onChange:e=>f(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(u.Button,{onClick:p,children:"Store UTXO"}),(0,t.jsx)(u.Button,{variant:"outline",onClick:m,children:"Back"})]})]})]})}function b({resultOutpoint:e,txid:s,beefBase64:r,height:n,onReset:i}){return(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsx)(c.CardTitle,{style:{color:"#16a34a"},className:"dark:text-green-400",children:"✓ UTXO Added"})}),(0,t.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("p",{className:"text-sm",children:["Successfully added ",(0,t.jsx)("code",{className:"text-xs",children:e})," to your inventory."]}),(0,t.jsxs)("div",{className:"space-y-2 rounded-md border p-3",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Archive Status:"}),(0,t.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{style:{color:"#16a34a"},children:"✓"})," Dossier created"]}),(0,t.jsx)("li",{className:"flex items-center gap-2",children:r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{style:{color:"#16a34a"},children:"✓"})," BEEF proof stored (height ",n,")"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-yellow-500",children:"○"}),(0,t.jsxs)("span",{className:"text-yellow-600 dark:text-yellow-400",children:["No BEEF proof — go to ",(0,t.jsx)("a",{href:"/validation",className:"underline",children:"Validation page"})," to fetch"]})]})}),(0,t.jsxs)("li",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"○"}),(0,t.jsxs)("span",{className:"text-muted-foreground",children:["Headers — go to ",(0,t.jsx)("a",{href:"/validation",className:"underline",children:"Validation page"})," to sync"]})]})]})]}),!r&&(0,t.jsxs)("div",{className:"rounded-md border border-yellow-500/20 bg-yellow-500/5 p-3 text-sm text-yellow-600 dark:text-yellow-400",children:[(0,t.jsx)("p",{className:"font-medium",children:"BEEF proof not available"}),(0,t.jsx)("p",{className:"mt-1",children:"This can happen if the transaction is unconfirmed or the proof service is unavailable. You can manually fetch BEEF later from the Validation page using the txid."})]}),(0,t.jsx)(a.Separator,{}),(0,t.jsx)("p",{className:"text-sm font-medium",children:"Next Steps:"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)(u.Button,{onClick:i,children:"Add Another UTXO"}),!r&&(0,t.jsx)(u.Button,{variant:"outline",asChild:!0,children:(0,t.jsx)("a",{href:`/beef?txid=${s}`,children:"Fetch BEEF"})}),r&&(0,t.jsx)(u.Button,{variant:"outline",asChild:!0,children:(0,t.jsx)("a",{href:"/validation?action=verify",children:"Verify Proof"})}),(0,t.jsx)(u.Button,{variant:"outline",asChild:!0,children:(0,t.jsx)("a",{href:"/dossiers",children:"View Dossiers"})}),(0,t.jsx)(u.Button,{variant:"outline",asChild:!0,children:(0,t.jsx)("a",{href:"/export",children:"Export Backup"})})]})]})]})}function v({buckets:e}){let{save:a}=(0,s.useDossiers)(),{save:c}=(0,i.useBeefStore)(),{mode:u,requestOnline:h}=(0,l.useNetworkMode)(),[x,f]=r.useState("input"),[v,w]=r.useState("utxo"),[N,C]=r.useState(""),[k,S]=r.useState(null),[B,T]=r.useState(!1),[E,F]=r.useState(null),[$,_]=r.useState(null),[I,O]=r.useState([]),[H,A]=r.useState(null),[U,V]=r.useState(null),[D,L]=r.useState(null),[P,R]=r.useState(null),[z,X]=r.useState(e[0]?.id??""),[M,W]=r.useState(""),[J,K]=r.useState(null),Y=async()=>{if(S(null),!N.trim())return void S("Please enter a value.");let e=N.trim();if("utxo"===v){let t=e.split(":"),a=t[0].toLowerCase();if(64!==a.length||!/^[a-f0-9]+$/.test(a))return void S("Invalid txid format. Expected 64 hex characters.");if(_(a),t.length>1){let e=parseInt(t[1],10);isNaN(e)||R(e)}let s="online_shielded"===u;if(s||(s=await h()),s){T(!0),F("Fetching transaction data...");try{let e=await (0,d.fetchRawTx)(a);if(e){let t=y(e);O(t)}let t=await (0,d.assembleBeefFromTxid)(a);t?(A(btoa(String.fromCharCode(...j(t.beefHex)))),V(t.height),F(`Fetched BEEF proof (block ${t.height})`)):e?F("Fetched raw tx (no BEEF proof available)"):F("Could not fetch transaction. Enter outputs manually.")}catch(e){F(`Fetch error: ${e instanceof Error?e.message:"Unknown"}`)}finally{T(!1)}}else F("Offline mode - enter outputs manually or go online to fetch.");f("select-output")}else if("beef"===v)try{let t=JSON.parse(e);if(!t.txid||!t.beef)return void S("Invalid BEEF format. Expected {txid, beef, ...}");_(t.txid),A(t.beef),V(t.height??null),L(t.header_hash??null),O(t.utxos??[]),f("select-output")}catch{S("Invalid JSON format.")}else if("rawtx"===v)try{let t=y(e),a=e.slice(0,64).toLowerCase();_(a),O(t),f("select-output")}catch(e){S(`Failed to parse raw tx: ${e instanceof Error?e.message:"Unknown"}`)}},q=async()=>{if(!$)return void S("No transaction ID.");S(null);try{let t=P??0,s=I.find(e=>e.vout===t),r=`${$}:${t}`,n={outpoint:r,value_satoshis:s?.satoshis??0,locking_script_hex:s?.script_hex??null,funding_txid:$,funding_tx_raw:null,bucket:z||e[0]?.id||"default",labels:M.split(",").map(e=>e.trim()).filter(Boolean),derivation_hint:null,beef_hash:null,verified:null,created_at:new Date().toISOString()};if(H){let e=await (0,o.computeBeefHash)(H),t={txid:$,beef:H,beef_hash:e,height:U??0,header_hash:D??"",utxos:I,labels:n.labels,bucket:n.bucket,created_at:new Date().toISOString(),integrity:{archive_hash:e,algo:"sha256"}};await c(t),n.beef_hash=e}await a(n),K(r),f("done")}catch(e){S(`Store error: ${e instanceof Error?e.message:"Unknown"}`)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(n.Badge,{variant:"input"===x?"default":"outline",children:"1. Input"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"→"}),(0,t.jsx)(n.Badge,{variant:"select-output"===x?"default":"outline",children:"2. Select Output"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"→"}),(0,t.jsx)(n.Badge,{variant:"store"===x?"default":"outline",children:"3. Store"}),(0,t.jsx)("span",{className:"text-muted-foreground",children:"→"}),(0,t.jsx)(n.Badge,{variant:"done"===x?"default":"outline",children:"4. Done"})]}),k&&(0,t.jsx)("div",{className:"rounded-md border border-red-500/20 bg-red-500/5 p-3 text-sm text-red-600 dark:text-red-400",children:k}),"input"===x&&(0,t.jsx)(p,{inputType:v,setInputType:w,inputValue:N,setInputValue:C,fetchStatus:E,fetching:B,isOnline:"online_shielded"===u,onContinue:Y}),"select-output"===x&&$&&(0,t.jsx)(m,{txid:$,outputs:I,selectedVout:P,setSelectedVout:R,onContinue:()=>{null===P&&I.length>0?S("Please select an output."):(S(null),f("store"))},onBack:()=>f("input")}),"store"===x&&$&&(0,t.jsx)(g,{txid:$,selectedVout:P??0,outputs:I,beefBase64:H,height:U,buckets:e,selectedBucket:z,setSelectedBucket:X,labels:M,setLabels:W,onStore:q,onBack:()=>f("select-output")}),"done"===x&&J&&$&&(0,t.jsx)(b,{resultOutpoint:J,txid:$,beefBase64:H,height:U,onReset:()=>{f("input"),w("utxo"),C(""),S(null),F(null),_(null),O([]),A(null),V(null),L(null),R(null),X(e[0]?.id??""),W(""),K(null)}})]})}function j(e){let t=new Uint8Array(e.length/2);for(let a=0;a<e.length;a+=2)t[a/2]=parseInt(e.substr(a,2),16);return t}function y(e){let t=[];try{let a=j(e),s=4,r=a[4];s++;for(let e=0;e<r;e++){let e=a[s+=36];s+=1+e+4}let n=a[s];s++;for(let e=0;e<n;e++){let r=0;for(let e=0;e<8;e++)r+=a[s+e]*Math.pow(256,e);let n=a[s+=8];s++;let i=Array.from(a.slice(s,s+n)).map(e=>e.toString(16).padStart(2,"0")).join("");s+=n,t.push({vout:e,satoshis:r,script_hex:i})}}catch{}return t}function w({buckets:e,saveDossier:a}){let[s,n]=r.useState(""),[i,l]=r.useState(null),[o,d]=r.useState(!1),h=async()=>{if(l(null),!s.trim())return void l("Please paste CSV data.");d(!0);try{let t=s.trim().split("\n"),r=0,i=0;for(let s of t){if(s.toLowerCase().startsWith("txid")||s.toLowerCase().startsWith("#"))continue;let t=s.split(",").map(e=>e.trim());if(t.length<3){i++;continue}let[n,l,o,d,c]=t,u=n?.toLowerCase(),h=parseInt(l??"0",10),x=parseInt(o??"0",10);if(!u||64!==u.length||isNaN(h)||isNaN(x)){i++;continue}let f=`${u}:${h}`,p=d||e[0]?.id||"default",m=c?[c]:[],g={outpoint:f,value_satoshis:x,locking_script_hex:null,funding_txid:u,funding_tx_raw:null,bucket:p,labels:m,derivation_hint:null,beef_hash:null,verified:null,created_at:new Date().toISOString()};await a(g),r++}n(""),l(`Imported ${r} UTXO(s). ${i>0?`Skipped ${i} invalid line(s).`:""}`)}catch(e){l(`Import error: ${e instanceof Error?e.message:"Unknown"}`)}finally{d(!1)}};return(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsx)(c.CardTitle,{children:"Bulk CSV Import"})}),(0,t.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Import multiple UTXOs from CSV. Format: ",(0,t.jsx)("code",{children:"txid,vout,satoshis,bucket,label"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Note: This creates dossier entries without BEEF proofs. You can fetch BEEF later from the BEEF page using the txids."}),i&&(0,t.jsx)("div",{className:"rounded-md border border-blue-500/20 bg-blue-500/5 p-3 text-sm text-blue-600 dark:text-blue-400",children:i}),(0,t.jsx)(f.Textarea,{placeholder:`# txid,vout,satoshis,bucket,label
abc123...def,0,100000,cold-a,my savings
xyz789...ghi,1,50000,cold-b,`,value:s,onChange:e=>n(e.target.value),rows:8,className:"font-mono text-xs"}),(0,t.jsx)(u.Button,{onClick:h,disabled:o,children:o?"Importing...":"Import CSV"})]})]})}function N(){let{buckets:e,save:r}=(0,s.useDossiers)();return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:"Add UTXO"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add a new UTXO to your inventory by providing transaction details."})]}),(0,t.jsx)(v,{buckets:e}),(0,t.jsx)(a.Separator,{}),(0,t.jsx)(w,{buckets:e,saveDossier:r})]})}e.s(["default",()=>N],79406)},28627,e=>{e.v(t=>Promise.all(["static/chunks/4c8470885cb93521.js","static/chunks/1cf82a77f52cdf80.js"].map(t=>e.l(t))).then(()=>t(44270)))}]);